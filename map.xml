<?xml version="1.0" encoding="utf-8"?>
<map proto="1.3.5">
	<name>Seasonal Wave</name>
	<version>0.1.0</version>
	<objective>コントロールポイントの制圧 / Capture the Control Point</objective>

	<authors>
		<author>EEE</author>
	</authors>

	<teams>
		<team max="12" color="red">Red Team</team>
		<team max="12" color="yellow">Yellow Team</team>
	</teams>

<!-- チームごとの初期装備 -->
	<kits>
		<kit id="default">
			<!-- ホットバー -->
			<item slot="9" amount="3" bind="true">Arrow</item>
			<!--ポーション効果 -->
			<potion duration="oo" amplifier="0">Speed</potion>
			<potion duration="oo" amplifier="-200">Hunger</potion>
			<potion duration="oo" amplifier="3">Damage Resistance</potion>
		</kit>
		<kit id="red" parents="default">
			<!-- 装備 -->
			<helmet color="ff0000" damage="-3000" locked="true">Leather Helmet</helmet>
			<boots color="ff0000" damage="-3000" locked="true">Leather Boots</boots>
			<!-- ホットバー -->
			<item slot="7" amount="16" damage="14">Stained Glass</item>
			<item slot="8" amount="64" damage="14">Stained Clay</item>
		</kit>
		<kit id="yellow" parents="default">
			<!-- 装備 -->
			<helmet color="ffff00" damage="-3000" locked="true">Leather Helmet</helmet>
			<boots color="ffff00" damage="-3000" locked="true">Leather Boots</boots>
			<!-- ホットバー -->
			<item slot="7" amount="16" damage="4">Stained Glass</item>
			<item slot="8" amount="64" damage="4">Stained Clay</item>
		</kit>
		<kit id="rage">
			<!-- ホットバー -->
			<item slot="2" damage="-3000" enchantment="DAMAGE_ALL:1">Diamond Pickaxe</item>
			<item slot="0">Bow</item>
			<potion duration="oo" amplifier="-500">Damage Resistance</potion>
		</kit>
	</kits>

<!-- スポーン位置 -->
	<spawns>
		<spawn team="red" yaw="-90" kit="red">
			<cuboid min="-78,10,56" max="-74,10,60" />
		</spawn>
		<spawn team="yellow" yaw="90" kit="yellow">
			<cuboid min="74,8,-60" max="78,8,-56" />
		</spawn>
		<default yaw="0">
			<cuboid min="-2,50,-1" max="2,50,1" />
		</default>
	</spawns>

<!-- フィルター定義 -->
	<filters>
		<filter id="not-editable" parents="deny-blocks"></filter>
		<filter id="outside">
			<not>
				<void/>
			</not>
		</filter>
	</filters>

<!-- 領域定義 -->
	<regions>
		<rectangle id="map" min="-68,-85" max="68,85" /><!-- マップ全体 -->
		<!-- チーム拠点定義と保護 -->
		<union id="Base">
			<cuboid id="red-base" min="-79,6,55" max="-73,255,61"/>
			<cuboid id="yellow-base" min="73,6,-61" max="79,255,-55"/>
		</union>
		<apply block="not-editable" block-place="deny-all" message="You may not modify bases.">
			<region id="Base"/>
		</apply>
		<!-- CP定義と保護 -->
		<union id="CP">
			<cuboid id="R1" min="-85,0,48" max="-54,48,67"></cuboid>
			<cuboid id="R2" min="-16,0,19" max="15,48,38"></cuboid>
			<cuboid id="R3" min="-62,0,19" max="-31,48,38"></cuboid>
			<cuboid id="R4" min="7,0,48" max="38,48,67"></cuboid>
			<cuboid id="R5" min="-85,0,-10" max="-54,48,9"></cuboid>
			<cuboid id="R6" min="-39,0,48" max="-8,48,67"></cuboid>
			<cuboid id="R7" min="-39,0,-10" max="-8,48,9"></cuboid>
			<cuboid id="R8" min="30,0,19" max="61,48,38"></cuboid>
			<cuboid id="R9" min="53,0,48" max="84,48,67"></cuboid>

			<cuboid id="Y1" min="53,0,-68" max="84,48,-49"></cuboid>
			<cuboid id="Y2" min="-16,0,-39" max="15,48,-20"></cuboid>
			<cuboid id="Y3" min="30,0,-39" max="61,48,-20"></cuboid>
			<cuboid id="Y4" min="-39,0,-68" max="-8,48,-49"></cuboid>
			<cuboid id="Y5" min="53,0,-10" max="84,48,9"></cuboid>
			<cuboid id="Y6" min="7,0,-68" max="38,48,-49"></cuboid>
			<cuboid id="Y7" min="7,0,-10" max="38,48,9"></cuboid>
			<cuboid id="Y8" min="-62,0,-39" max="-31,48,-20"></cuboid>
			<cuboid id="Y9" min="-85,0,-68" max="-54,48,-49"></cuboid>
		</union>
		<apply block="not-editable" block-place="deny-all" message="You may not modify Control Point.">
			<region id="CP"/>
		</apply>
		<apply kit="rage">
			<negative>
				<region id="Base"/>
			</negative>
		</apply>
		<!-- 領域外 -->
		<apply block="outside" message="You may not modify void area.">
			<rectangle min="-oo,-oo" max="oo,oo"/>
		</apply>
	</regions>

	<!-- CPの定義 -->
	<controlpoints score-limit="4000">
	<!-- R -->
		<controlpoint name="R1" score="10" capture-time="2s">
			<capture>
				<cuboid min="-85,0,48" max="-54,48,67"></cuboid>
			</capture>
			<flag>
				<cuboid min="-85,0,48" max="-54,48,67"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="R2" score="20" capture-time="4s">
			<capture>
				<cuboid min="-16,0,19" max="15,48,38"></cuboid>
			</capture>
			<flag>
				<cuboid min="-16,0,19" max="15,48,38"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="R3" score="30" capture-time="6s">
			<capture>
				<cuboid min="-62,0,19" max="-31,48,38"></cuboid>
			</capture>
			<flag>
				<cuboid min="-62,0,19" max="-31,48,38"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="R4" score="40" capture-time="8s">
			<capture>
				<cuboid min="7,0,48" max="38,48,67"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="7,0,48" max="38,7,67"></cuboid>
					<cuboid min="7,17,48" max="38,48,67"></cuboid>
				</union>
			</flag>
		</controlpoint>
		<controlpoint name="R5" score="50" capture-time="10s">
			<capture>
				<cuboid min="-85,0,-10" max="-52,48,9"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="-85,0,-10" max="-52,7,9"></cuboid>
					<cuboid min="-85,17,-10" max="-52,48,9"></cuboid>
				</union>
			</flag>
		</controlpoint>
		<controlpoint name="R6" score="60" capture-time="12s">
			<capture>
				<cuboid min="-39,0,48" max="-8,48,67"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="-39,0,48" max="-8,7,67"></cuboid>
					<cuboid min="-39,17,48" max="-8,48,67"></cuboid>
				</union>
			</flag>
		</controlpoint>
		<controlpoint name="R7" score="70" capture-time="14s">
			<capture>
				<cuboid min="-39,0,-10" max="-8,48,9"></cuboid>
			</capture>
			<flag>
				<cuboid min="-39,0,-10" max="-8,48,9"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="R8" score="80" capture-time="16s">
			<capture>
				<cuboid min="30,0,19" max="61,48,38"></cuboid>
			</capture>
			<flag>
				<cuboid min="30,0,19" max="61,48,38"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="R9" score="90" capture-time="18s">
			<capture>
				<cuboid min="53,0,48" max="84,48,67"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="53,0,48" max="84,7,67"></cuboid>
					<cuboid min="53,30,48" max="84,48,67"></cuboid>
					<cuboid min="53,0,48" max="58,48,58"></cuboid>
				</union>
			</flag>
		</controlpoint>
		<!-- Y(Rのx,z座標符号反転) -->
		<controlpoint name="Y1" score="10" capture-time="2s">
			<capture>
				<cuboid min="53,0,-68" max="84,48,-49"></cuboid>
			</capture>
			<flag>
				<cuboid min="53,0,-68" max="84,48,-49"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="Y2" score="20" capture-time="4s">
			<capture>
				<cuboid min="-16,0,-39" max="15,48,-20"></cuboid>
			</capture>
			<flag>
				<cuboid min="-16,0,-39" max="15,48,-20"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="Y3" score="30" capture-time="6s">
			<capture>
				<cuboid min="30,0,-39" max="61,48,-20"></cuboid>
			</capture>
			<flag>
				<cuboid min="30,0,-39" max="61,48,-20"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="Y4" score="40" capture-time="8s">
			<capture>
				<cuboid min="-39,0,-68" max="-8,48,-49"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="-39,0,-68" max="-8,48,-49"></cuboid>
					<cuboid min="-39,0,-68" max="-8,48,-49"></cuboid>
				</union>
			</flag>
		</controlpoint>
		<controlpoint name="Y5" score="50" capture-time="10s">
			<capture>
				<cuboid min="53,0,-10" max="84,48,9"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="53,0,-10" max="84,7,9"></cuboid>
					<cuboid min="53,17,-10" max="84,48,9"></cuboid>
				</union>
			</flag>
		</controlpoint>
		<controlpoint name="Y6" score="60" capture-time="12s">
			<capture>
				<cuboid min="7,0,-68" max="38,48,-49"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="7,0,-68" max="38,7,-49"></cuboid>
					<cuboid min="7,17,-68" max="38,48,-49"></cuboid>
				</union>
			</flag>
		</controlpoint>
		<controlpoint name="Y7" score="70" capture-time="14s">
			<capture>
				<cuboid min="7,0,-10" max="38,48,9"></cuboid>
			</capture>
			<flag>
				<cuboid min="7,0,-10" max="38,48,9"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="Y8" score="80" capture-time="16s">
			<capture>
				<cuboid min="-62,0,-39" max="-31,48,-20"></cuboid>
			</capture>
			<flag>
				<cuboid min="-62,0,-39" max="-31,48,-20"></cuboid>
			</flag>
		</controlpoint>
		<controlpoint name="Y9" score="90" capture-time="18s">
			<capture>
				<cuboid min="-85,0,-68" max="-54,48,-49"></cuboid>
			</capture>
			<flag>
				<union>
					<cuboid min="-85,0,-68" max="-54,6,-49"></cuboid>
					<cuboid min="-85,30,-68" max="-54,48,-49"></cuboid>
					<cuboid min="-59,0,-59" max="-54,48,-49"></cuboid>
				</union>
			</flag>
		</controlpoint>
	</controlpoints>
	<itemremove>
		<item>Diamond Pickaxe</item>
		<item>Bow</item>
		<item>Arrow</item>
		<item>Golden Carrot</item>
		<item>Stained Clay</item>
		<item>Stained Glass</item>
		<item>Glass</item>
		<item>Leather Helmet</item>
		<item>Leather Boots</item>
	</itemremove>

	<!-- キル報酬 -->
	<killreward>
		<item amount="3">Arrow</item>
		<item amount="16">Glass</item>
	</killreward>
	
	<killreward>
		<filter>
			<kill-streak count="7"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="14"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="21"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="28"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="35"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="42"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="49"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="56"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="63"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="70"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="77"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="84"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="91"/>
		</filter>
		<item amount="1" bind="true">Ender Pearl</item>
	</killreward>
	<killreward>
		<filter>
			<kill-streak count="98"/>
		</filter>
		<item amount="64" bind="true">Ender Pearl</item>
	</killreward>

	<!--  落下ダメージ無効  -->
	<disabledamage>
		<damage>fall</damage>
	</disabledamage>

	<!-- ブロックドロップ拒否 -->
	<blockdrops>
		<rule>
			<region>
				<region id="map"/>
			</region>
			<filter>
				<block>Stained Clay</block>
				<block>Stained Glass</block>
			</filter>
		</rule>
	</blockdrops>

	<!-- 限界高度 -->
	<maxbuildheight>22</maxbuildheight>
	
	<script src="map.js"/>

	<!-- チュートリアル -->
	<include src="tutorial.xml"/>
	<tutorial>
		<stage title="Control Point (CP)">
			<message>
				<line>This map is a "Control Point"(CP) map.</line>
				<line>Team that have more control points than the other will win at the end.</line>
				<line>You can kill enemies only `a`lone hit(RAGE)`r.</line>
			</message>
			<message lang="ja_JP">
				<line>このマップは "Control Point(コントロールポイント)"(CP)マップです。</line>
				<line>終了時になるべく多くのコントロールポイントを制圧したチームの勝ちです。</line>
				<line>このマップでは`a`l一撃で敵を倒すことができます(RAGE)`r。</line>
			</message>
			<teleport>
				<point yaw="0" piitch="30">0,60,0</point>
			</teleport>
		</stage>
		<!-- 落下ダメージについて -->
		<stage title="Falling Damage">
			<title lang="ja_JP">落下ダメージ</title>
			<message>
				<line>Falling damage is disabled in this map.</line>
			</message>
			<message lang="ja_JP">
				<line>このmapでは落下ダメージが無効になります。</line>
		</message>
		</stage>
		<!-- スポーン場所の説明 -->
		<stage title="Red-Base">
		    <message>
    			 <line>This is red team spawn point.</line>
			</message>
		    <message lang="ja_JP">
			     <line>赤チームのスポーン場所はここです。</line>
		    </message>
   			<teleport>
   				<point yaw="-90" pitch="45">-80,15,58</point>
			</teleport>
		</stage>
		<stage title="Yellow-Base">
		    <message>
    			 <line>This is yellow team spawn point.</line>
			</message>
		    <message lang="ja_JP">
			     <line>黄チームのスポーン場所はここです。</line>
		    </message>
   			<teleport>
   				<point yaw="90" pitch="45">80,15,-58</point>
			</teleport>
		</stage>
		<!-- CPの説明 -->	
		<stage title="CP">
		    <message>
    			 <line>All islands in this map are CP.</line>
    			 <line>You can not modify blocks in the CP.</line>
			</message>
		    <message lang="ja_JP">
			     <line>マップ上にある全ての浮島がCPです。</line>
			     <line>CPの領域は編集不可です。</line>
		    </message>
   			<teleport>
   				<point yaw="180" pitch="15">0,61,90</point>
			</teleport>
		</stage>
	</tutorial>
</map>
